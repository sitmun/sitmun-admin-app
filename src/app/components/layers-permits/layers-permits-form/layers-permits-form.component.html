<app-form-toolbar
  entityType="{{ config.labelSingular }}"
  font="{{ config.font }}"
  icon="{{ config.icon }}"
  [itemName]="entityForm?.get('name')?.value"
  [isNew]="isNewOrDuplicated()"
  (save)="onSaveButtonClicked()"
  (back)="utils.navigateBack()">
</app-form-toolbar>
<mat-tab-group
  mat-stretch-tabs="false"
  mat-align-tabs="end"
  [dynamicHeight]="true"
  preserveContent="true">
  <mat-tab label="{{ 'common.form.details' | translate }}">
  <form [formGroup]='entityForm' *ngIf="dataLoaded">
    <mat-card class="sitmun-mat-card-margin" appearance="outlined">
      <mat-card-content>
        <mat-form-field appearance="outline" class="full">
          <mat-label>{{ 'common.form.name' | translate }}</mat-label>
          <input matInput type="text" formControlName="name" required>
        </mat-form-field>
        <mat-form-field appearance="outline" class="quarter">
          <mat-label>{{ 'common.form.type' | translate }}</mat-label>
          <mat-select formControlName="type" class="form-control">
            <mat-option [value]="permissionGroupType.value" *ngFor="let permissionGroupType of permissionGroupTypes">
              {{permissionGroupType.description}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </mat-card-content>
    </mat-card>
  </form>
  </mat-tab>
  <mat-tab label=" {{ 'entity.permissionGroup.layers.header' | translate }}">
    <app-data-grid [changeHeightButton]="true"
                   [allNewElements]="isNewOrDuplicated()"
                   [columnDefs]="membersTable.relationsColumnsDefs"
                   [getAll]='membersTable.relationsFetchFn'
                   [eventAddItemsSubscription]='membersTable.addCommandEvent$.asObservable()'
                   [eventGetAllRowsSubscription]='membersTable.saveCommandEvent$.asObservable()'
                   [eventRefreshSubscription]='membersTable.refreshCommandEvent$.asObservable()'
                   [actionButton]=true
                   [discardChangesButton]=true
                   [redoButton]=true
                   [undoButton]=true
                   [deleteButton]=true
                   [addButton]=true
                   [hideDuplicateButton]=true
                   [hideReplaceButton]=true
                   [hideReplaceAllButton]=true
                   [defaultColumnSorting]='membersTable.defaultRelationsSorting()'
                   (getAllRows)="membersTable.handleSaveRelations($event)"
                   (add)="membersTable.openDialog($event)"
                   *ngIf="dataLoaded"
    > </app-data-grid>
  </mat-tab>
  <mat-tab label="{{ 'entity.permissionGroup.roles.header' | translate }}">
    <app-data-grid [changeHeightButton]="true"
                   [allNewElements]="isNewOrDuplicated()"
                   [columnDefs]="rolesTable.relationsColumnsDefs"
                   [getAll]='rolesTable.relationsFetchFn'
                   [eventAddItemsSubscription]='rolesTable.addCommandEvent$.asObservable()'
                   [eventGetAllRowsSubscription]='rolesTable.saveCommandEvent$.asObservable()'
                   [eventRefreshSubscription]='rolesTable.refreshCommandEvent$.asObservable()'
                   [actionButton]=true
                   [discardChangesButton]=true
                   [redoButton]=true
                   [undoButton]=true
                   [deleteButton]=true
                   [addButton]=true
                   [hideDuplicateButton]=true
                   [hideReplaceButton]=true
                   [defaultColumnSorting]='rolesTable.defaultRelationsSorting()'
                   (getAllRows)="rolesTable.handleSaveRelations($event)"
                   (add)="rolesTable.openDialog($event)"
                   *ngIf="dataLoaded"
    > </app-data-grid>
  </mat-tab>
  <mat-tab label="{{ 'entity.permissionGroup.applications.header' | translate }}">
    <app-data-grid [changeHeightButton]="true"
                   [allNewElements]="isNewOrDuplicated()"
                   [columnDefs]="applicationsTable.relationsColumnsDefs"
                   [getAll]='applicationsTable.relationsFetchFn'
                   [eventAddItemsSubscription]='applicationsTable.addCommandEvent$.asObservable()'
                   [eventGetAllRowsSubscription]='applicationsTable.saveCommandEvent$.asObservable()'
                   [eventRefreshSubscription]='applicationsTable.refreshCommandEvent$.asObservable()'
                   [actionButton]=false
                   [discardChangesButton]=false
                   [redoButton]=false
                   [undoButton]=false
                   [deleteButton]=false
                   [addButton]=false
                   [hideDuplicateButton]=false
                   [hideReplaceButton]=true
                   [defaultColumnSorting]='applicationsTable.defaultRelationsSorting()'
                   (getAllRows)="applicationsTable.handleSaveRelations($event)"
                   (add)="applicationsTable.openDialog($event)"
                   *ngIf="dataLoaded"
    > </app-data-grid>
  </mat-tab>
</mat-tab-group>
